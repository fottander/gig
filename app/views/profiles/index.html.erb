<h3>Alla frilansare</h3>
<div class='breadcrumb-holder'>
    <%= render_breadcrumbs separator: ' > ' %>
</div>
<div class="button-select-section">
  <div class="row">
    <%= form_tag profiles_path, method: 'get' do %>
      <div class='large-4 columns'>
        <%= select_tag :with_category, options_for_select(Category.pluck(:name)), class: 'button-select', prompt: 'Välj Kategori' %>
      </div>
      <div class='large-4 columns'>
        <%= select_tag :with_city, options_for_select(City.pluck(:name)), class: 'button-select', prompt: 'Välj Stad' %>
      </div>
      <div class='large-4 columns'>
        <%= submit_tag 'Filtrera', class: 'filter-button' %>
        <%= link_to 'x töm filter', profiles_path, class: 'empty-filter' %>
      </div>
    <% end %>
  </div>
</div>

<% @profiles.each do |profile| %>
<div class='profile-<%= profile.id %>'>
  <div class="card profile-card-action-icons">
    <div class="card-section">
      <div class="profile-card-header">
        <div class="profile-card-avatar">
          <%= image_tag profile.avatar.url, class: "avatar-image" %>
        </div>
        <div class="profile-card-author">
          <h4 class="author-title"><%= link_to profile.username, profile_path(profile)%></h4>
          <%= profile.title %>
          <div class="small-12 medium-2 columns add-friend">
            <%= link_to 'Visa', profile_path(profile), class: 'reply-button' %>
          </div>
        </div>
      </div>
      <div class="profile-card-about">
          <div class="profile-card-about-message">
            |<% profile.categories.each do |category| %>
              <span class='profile-card-about-title'><%= category.name %></span> |
            <% end %><br>
            <% if profile.description.length > 100 %>
                <%= truncate(profile.description, length: 100) %>
            <% else %>
                <%= profile.description %>
            <% end %>
            <div class='row'>
              <div class='large-2 columns'>
                <% profile.cities.each do |city| %>
                  Stad: <%= city.name %>
                <% end %>
              </div>
              <div class='large-2 columns'>
                Färdigheter:
                <% if profile.skill.length > 40 %>
                  <%= truncate(profile.skill, length: 40) %>
                <% else %>
                  <%= profile.skill %>
                <% end %>
              </div>
              <div class='large-2 columns'>
                  Lön: <%= profile.rate %>
              </div>
              <div class='large-2 columns'>
                Genomförda jobb: <%= @invoices.with_profile_id(profile.id).count %>
              </div>
              <div class='large-2 columns'>
                Totalt fakturerat: <br>
                <% if (@invoices.with_profile_id(profile.id).sum('amount') * 1.25).round < 10000 %>
                  0 - 10 000 kr
                <% elsif (10000..15000).include? (@invoices.with_profile_id(profile.id).sum('amount') * 1.25).round %>
                  10 000 - 15 000 kr
                <% elsif (15001..25000).include? (@invoices.with_profile_id(profile.id).sum('amount') * 1.25).round %>
                  15 000 - 25 000 kr
                <% elsif (25001..50000).include? (@invoices.with_profile_id(profile.id).sum('amount') * 1.25).round %>
                  25 000 - 50 000 kr
                <% elsif (50001..100000).include? (@invoices.with_profile_id(profile.id).sum('amount') * 1.25).round %>
                  50 000 - 100 000 kr
                <% elsif (100001..249999).include? (@invoices.with_profile_id(profile.id).sum('amount') * 1.25).round %>
                  100 000 - 250 000 kr
                <% elsif (@invoices.with_profile_id(profile.id).sum('amount') * 1.25).round > 249999 %>
                  Mer än 250 000 kr
                <% end %>
              </div>
              <div class='columns'>
              </div>
            </div>
          </div>
      </div>
    </div>
  </div>
</div>
<% end %>

<div class="will-paginate">
    <%= will_paginate @profiles, renderer: FoundationPagination::Rails, previous_label: 'Tidigare', next_label: 'Nästa', inner_window: 1, outer_window: 1 %>
</div>
